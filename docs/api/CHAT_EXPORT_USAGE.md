# 聊天历史导出功能使用说明

## 概述

聊天历史导出功能允许您将当前会话的对话记录导出为 JSON 格式文件，方便保存和后续查看。

## 功能特点

- ✅ 支持导出完整的对话历史
- ✅ 包含会话元数据（开始时间、结束时间、消息数量等）
- ✅ 包含当前配置信息
- ✅ 自动创建导出目录
- ✅ 使用 ES6 模块，兼容现代 JavaScript 环境

## 使用方法

### 在交互式测试中使用

1. 启动聊天测试：
   ```bash
   npm run test:chat
   ```

2. 进行一些对话后，使用导出命令：
   ```
   /export
   ```
   或简写：
   ```
   /e
   ```

3. 导出文件将保存在 `data/chat-history/` 目录下，文件名格式为：
   ```
   chat-export-{threadId}.json
   ```

### 导出文件结构

导出的 JSON 文件包含以下信息：

```json
{
  "sessionId": "session_1758368994825",
  "startTime": "2024-01-20T10:30:00.000Z",
  "endTime": "2024-01-20T11:45:00.000Z",
  "messageCount": 15,
  "config": {
    "streaming": false,
    "temperature": 0,
    "model": "deepseek-chat"
  },
  "history": [
    {
      "timestamp": "2024-01-20T10:30:00.000Z",
      "role": "user",
      "content": "你好"
    },
    {
      "timestamp": "2024-01-20T10:30:01.000Z",
      "role": "assistant",
      "content": "你好！有什么我可以帮助您的吗？",
      "toolCalls": [],
      "metadata": {}
    }
  ],
  "exportedAt": "2024-01-20T11:45:00.000Z",
  "version": "1.0"
}
```

## 导出目录

- 默认导出目录：`data/chat-history/`
- 如果目录不存在，系统会自动创建
- 每次导出都会生成新的文件，不会覆盖之前的导出

## 注意事项

1. 只有在有对话历史的情况下才能导出
2. 导出功能使用本地文件系统，不需要网络连接
3. 导出的文件包含完整的对话上下文和元数据
4. 支持多次导出，每次都会生成新的文件

## 错误处理

- 如果没有会话历史，会显示错误提示
- 如果文件写入失败，会显示具体的错误信息
- 系统会自动处理目录创建失败的情况

## 示例

```
你: 你好，请帮我介绍一下这个系统
🤖 AI助手: 这是一个基于 LangGraph 的 AI 助手系统...

你: /export
📤 正在导出对话历史...
✅ 对话历史已导出到 data/chat-history/chat-export-session_1758368994825.json
  导出内容包含完整的聊天记录和元数据
```
